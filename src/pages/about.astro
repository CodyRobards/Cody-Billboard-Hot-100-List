---
import SiteLayout from "../layouts/SiteLayout.astro";
import ResponsiveImage from "../components/ResponsiveImage.astro";
import { getCollection } from "astro:content";

const [aboutEntry] = await getCollection("meta", ({ slug }) => slug === "about-the-archive");
const entry = aboutEntry ?? (await getCollection("meta"))[0];

if (!entry) {
  throw new Error("Missing about entry");
}

const { Content } = await entry.render();
const tags = entry.data.tags ?? [];
const showTags = false && tags.length > 0;
---

<SiteLayout pageTitle={entry.data.title} description={entry.data.commentary_excerpt}>
  <article class="article">
    <header class="article__header">
      <p class="article__kicker">Project overview</p>
      <h1>{entry.data.title}</h1>
      <p class="article__lede">{entry.data.commentary_excerpt}</p>
      <ResponsiveImage
        image={entry.data.cover_image}
        class="article__image"
        sizes="(min-width: 72rem) 32rem, 100vw"
      />
    </header>
    <div class="article__body">
      <p>{entry.data.commentary}</p>
      <Content />
    </div>
    {
      showTags ? (
        <div class="article__tags">
          {tags.map((tag) => (
            <span class="tag-chip">{tag}</span>
          ))}
        </div>
      ) : null
    }
  </article>
</SiteLayout>
